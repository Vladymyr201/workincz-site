<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - WorkInCZ</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#F59E0B',
                        success: '#10B981'
                    }
                }
            }
        }
    </script>
    
    <!-- Firebase -->
    <script src="js/firebase-app-compat.js"></script>
    <script src="js/firebase-auth-compat.js"></script>
    <script src="js/firebase-firestore-compat.js"></script>
    
    <!-- Auth Systems -->
    <script src="js/auth-manager.js"></script>
    <script src="js/enhanced-auth-system.js"></script>
    <script src="js/demo-login-system.js"></script>
    <script src="js/role-middleware.js"></script>
    <script src="js/dev-login.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">üß™ –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</h1>
                <p class="text-gray-600">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –≤—Ö–æ–¥–∞</p>
            </div>

            <!-- Firebase Status -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">üîß –°—Ç–∞—Ç—É—Å Firebase</h2>
                <div id="firebaseStatus" class="space-y-2">
                    <div class="flex items-center gap-2">
                        <div id="firebaseApp" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>Firebase App</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="firebaseAuth" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>Firebase Auth</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="firebaseFirestore" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>Firebase Firestore</span>
                    </div>
                </div>
            </div>

            <!-- Auth Systems Status -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">üîê –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
                <div id="authSystemsStatus" class="space-y-2">
                    <div class="flex items-center gap-2">
                        <div id="authManager" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>AuthManager</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="enhancedAuthSystem" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>EnhancedAuthSystem</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="demoLoginSystem" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>DemoLoginSystem</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="roleMiddleware" class="w-4 h-4 bg-gray-300 rounded-full"></div>
                        <span>RoleMiddleware</span>
                    </div>
                </div>
            </div>

            <!-- Test Buttons -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button onclick="testDemoLogin('candidate')" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                        üß™ –¢–µ—Å—Ç Demo-–≤—Ö–æ–¥–∞ (–°–æ–∏—Å–∫–∞—Ç–µ–ª—å)
                    </button>
                    <button onclick="testDemoLogin('client')" class="bg-secondary text-white px-4 py-2 rounded-lg hover:bg-secondary/90 transition-colors">
                        üß™ –¢–µ—Å—Ç Demo-–≤—Ö–æ–¥–∞ (–†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å)
                    </button>
                    <button onclick="testDemoLogin('agency')" class="bg-success text-white px-4 py-2 rounded-lg hover:bg-success/90 transition-colors">
                        üß™ –¢–µ—Å—Ç Demo-–≤—Ö–æ–¥–∞ (–ê–≥–µ–Ω—Ç—Å—Ç–≤–æ)
                    </button>
                    <button onclick="testMagicLink()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                        üß™ –¢–µ—Å—Ç Magic-Link
                    </button>
                </div>
            </div>

            <!-- Current User Info -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                <div id="currentUserInfo" class="text-gray-600">
                    –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                </div>
            </div>

            <!-- Console Log -->
            <div class="bg-gray-900 text-green-400 rounded-lg p-4 font-mono text-sm">
                <h3 class="text-white mb-2">üìã –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥:</h3>
                <div id="consoleLog" class="space-y-1 max-h-64 overflow-y-auto">
                    <div>–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAo34JvPwyqjwzjhd-d-qEKh7HqAAWsIiM",
            authDomain: "workincz-759c7.firebaseapp.com",
            projectId: "workincz-759c7",
            storageBucket: "workincz-759c7.appspot.com",
            messagingSenderId: "670842817143",
            appId: "1:670842817143:web:d8998634da78318e9f1472",
            databaseURL: "https://workincz-759c7-default-rtdb.europe-west1.firebasedatabase.app"
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message) {
            const consoleLog = document.getElementById('consoleLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${timestamp}] ${message}`;
            consoleLog.appendChild(logEntry);
            consoleLog.scrollTop = consoleLog.scrollHeight;
            console.log(message);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ Firebase
        function checkFirebase() {
            log('üîç –ü—Ä–æ–≤–µ—Ä—è—é Firebase...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase App
            if (typeof firebase !== 'undefined') {
                document.getElementById('firebaseApp').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ Firebase App –∑–∞–≥—Ä—É–∂–µ–Ω');
            } else {
                document.getElementById('firebaseApp').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå Firebase App –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase Auth
            if (firebase && firebase.auth) {
                document.getElementById('firebaseAuth').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ Firebase Auth –∑–∞–≥—Ä—É–∂–µ–Ω');
            } else {
                document.getElementById('firebaseAuth').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå Firebase Auth –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase Firestore
            if (firebase && firebase.firestore) {
                document.getElementById('firebaseFirestore').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ Firebase Firestore –∑–∞–≥—Ä—É–∂–µ–Ω');
            } else {
                document.getElementById('firebaseFirestore').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå Firebase Firestore –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        function checkAuthSystems() {
            log('üîç –ü—Ä–æ–≤–µ—Ä—è—é —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º AuthManager
            if (window.authManager) {
                document.getElementById('authManager').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ AuthManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                document.getElementById('authManager').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå AuthManager –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º EnhancedAuthSystem
            if (window.enhancedAuthSystem) {
                document.getElementById('enhancedAuthSystem').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ EnhancedAuthSystem –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                document.getElementById('enhancedAuthSystem').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå EnhancedAuthSystem –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º DemoLoginSystem
            if (window.demoLoginSystem) {
                document.getElementById('demoLoginSystem').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ DemoLoginSystem –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                document.getElementById('demoLoginSystem').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå DemoLoginSystem –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º RoleMiddleware
            if (window.roleMiddleware) {
                document.getElementById('roleMiddleware').className = 'w-4 h-4 bg-green-500 rounded-full';
                log('‚úÖ RoleMiddleware –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                document.getElementById('roleMiddleware').className = 'w-4 h-4 bg-red-500 rounded-full';
                log('‚ùå RoleMiddleware –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        function updateUserInfo() {
            const userInfo = document.getElementById('currentUserInfo');
            const user = firebase.auth().currentUser;
            
            if (user) {
                userInfo.innerHTML = `
                    <div class="space-y-2">
                        <div><strong>Email:</strong> ${user.email}</div>
                        <div><strong>UID:</strong> ${user.uid}</div>
                        <div><strong>Email Verified:</strong> ${user.emailVerified ? '–î–∞' : '–ù–µ—Ç'}</div>
                        <button onclick="logout()" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                            –í—ã–π—Ç–∏
                        </button>
                    </div>
                `;
                log(`üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ${user.email}`);
            } else {
                userInfo.textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
            }
        }

        // –¢–µ—Å—Ç Demo-–≤—Ö–æ–¥–∞
        async function testDemoLogin(role) {
            log(`üß™ –¢–µ—Å—Ç–∏—Ä—É—é Demo-–≤—Ö–æ–¥ –¥–ª—è —Ä–æ–ª–∏: ${role}`);
            
            if (!window.demoLoginSystem) {
                log('‚ùå DemoLoginSystem –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                return;
            }
            
            try {
                await window.demoLoginSystem.handleDemoLogin(role);
                log(`‚úÖ Demo-–≤—Ö–æ–¥ –¥–ª—è ${role} –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ`);
                updateUserInfo();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ Demo-–≤—Ö–æ–¥–∞: ${error.message}`);
            }
        }

        // –¢–µ—Å—Ç Magic-Link
        async function testMagicLink() {
            log('üß™ –¢–µ—Å—Ç–∏—Ä—É—é Magic-Link...');
            
            if (!window.demoLoginSystem) {
                log('‚ùå DemoLoginSystem –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                return;
            }
            
            const email = prompt('–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è Magic-Link:');
            if (!email) {
                log('‚ùå Email –Ω–µ –≤–≤–µ–¥–µ–Ω');
                return;
            }
            
            try {
                document.getElementById('magicLinkEmail').value = email;
                await window.demoLoginSystem.handleMagicLink();
                log('‚úÖ Magic-Link –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ Magic-Link: ${error.message}`);
            }
        }

        // –í—ã—Ö–æ–¥
        async function logout() {
            try {
                await firebase.auth().signOut();
                log('‚úÖ –í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω');
                updateUserInfo();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞: ${error.message}`);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', async () => {
            log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã...');
            
            try {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
                firebase.initializeApp(firebaseConfig);
                log('‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
                checkFirebase();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—ã
                window.authManager = new AuthManager();
                window.enhancedAuthSystem = new EnhancedAuthSystem();
                window.demoLoginSystem = new DemoLoginSystem();
                window.roleMiddleware = new RoleMiddleware();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏—Å—Ç–µ–º—ã
                setTimeout(checkAuthSystems, 1000);
                
                // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                firebase.auth().onAuthStateChanged((user) => {
                    updateUserInfo();
                });
                
                log('‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`);
            }
        });
    </script>
</body>
</html> 