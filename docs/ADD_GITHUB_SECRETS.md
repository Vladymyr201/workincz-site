# Настройка секретов в GitHub для успешной работы Actions

## Необходимые секреты

### Базовые секреты для деплоя Firebase
1. **FIREBASE_TOKEN**
   - Описание: Токен доступа для деплоя через Firebase CLI
   - Как получить: 
     ```bash
     firebase login:ci
     ```
     Команда выведет токен, который нужно скопировать

### Секреты для бэкапа Firestore
1. **GCP_PROJECT_ID**
   - Описание: ID проекта Google Cloud
   - Как найти: В консоли Firebase/GCP, это идентификатор в URL или в настройках проекта

2. **GCP_SA_KEY**
   - Описание: Ключ сервисного аккаунта в формате JSON
   - Как получить:
     1. Перейдите в GCP Console → IAM → Service Accounts
     2. Создайте новый сервисный аккаунт или выберите существующий
     3. Добавьте необходимые роли: `Firestore Admin`, `Storage Admin`
     4. Создайте и скачайте JSON ключ
     5. Скопируйте все содержимое JSON файла

3. **GCP_SA_EMAIL**
   - Описание: Email сервисного аккаунта
   - Где найти: В сведениях о сервисном аккаунте или в JSON ключе (поле `client_email`)

4. **GCS_BUCKET**
   - Описание: Имя Google Cloud Storage бакета для хранения бэкапов
   - Формат: `your-bucket-name` (без префикса gs://)

5. **BACKUP_ENCRYPTION_KEY** (опционально)
   - Описание: Ключ для шифрования бэкапов
   - Рекомендация: Используйте надежный случайный пароль длиной не менее 32 символов

6. **SLACK_WEBHOOK_URL** (опционально)
   - Описание: URL для отправки уведомлений в Slack
   - Как получить: В настройках Slack в разделе Incoming Webhooks

## Как добавить секреты в GitHub

1. Перейдите в репозиторий на GitHub
2. Нажмите на вкладку "Settings"
3. В боковом меню выберите "Secrets and variables" → "Actions"
4. Нажмите кнопку "New repository secret"
5. Введите имя секрета и его значение
6. Нажмите "Add secret"

## Проверка настройки

После добавления всех необходимых секретов, запустите workflow "Firebase Deploy" или "Firestore Backup" вручную через интерфейс GitHub Actions, чтобы убедиться, что все работает правильно.

## Устранение неполадок

### Ошибка: "Context access might be invalid"
Означает, что секрет не настроен в репозитории или имеет неверное имя. Проверьте список секретов и убедитесь, что имена совпадают с теми, что используются в workflow файлах.

### Ошибка аутентификации Firebase/GCP
Убедитесь, что:
1. Токен Firebase не истек (срок действия обычно 1 месяц)
2. Сервисный аккаунт имеет все необходимые права
3. JSON ключ сервисного аккаунта корректен и не поврежден