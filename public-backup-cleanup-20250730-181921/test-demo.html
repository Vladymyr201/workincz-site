<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –¥–µ–º–æ–≤—Ö–æ–¥–∞ - WorkInCZ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .log-entry { margin: 2px 0; padding: 2px 4px; border-radius: 4px; }
        .log-success { background-color: #d1fae5; color: #065f46; }
        .log-error { background-color: #fee2e2; color: #991b1b; }
        .log-info { background-color: #dbeafe; color: #1e40af; }
        .log-warning { background-color: #fef3c7; color: #92400e; }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">üîê –¢–µ—Å—Ç –¥–µ–º–æ-–≤—Ö–æ–¥–∞ WorkInCZ</h1>
            
            <div class="grid md:grid-cols-3 gap-4 mb-6">
                <button onclick="testDemoLogin('candidate')" class="bg-blue-500 text-white py-4 px-6 rounded-lg hover:bg-blue-600 transition-colors">
                    <div class="text-lg font-semibold">üë§ –°–æ–∏—Å–∫–∞—Ç–µ–ª—å</div>
                    <div class="text-sm opacity-90">–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç—ã, –∑–∞—è–≤–∫–∏</div>
                </button>
                
                <button onclick="testDemoLogin('client')" class="bg-green-500 text-white py-4 px-6 rounded-lg hover:bg-green-600 transition-colors">
                    <div class="text-lg font-semibold">üè¢ –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å</div>
                    <div class="text-sm opacity-90">–†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–π</div>
                </button>
                
                <button onclick="testDemoLogin('agency')" class="bg-purple-500 text-white py-4 px-6 rounded-lg hover:bg-purple-600 transition-colors">
                    <div class="text-lg font-semibold">üèõÔ∏è –ê–≥–µ–Ω—Ç—Å—Ç–≤–æ</div>
                    <div class="text-sm opacity-90">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏</div>
                </button>
            </div>
            
            <div class="flex gap-4 mb-6">
                <button onclick="clearLog()" class="bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600">
                    –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥
                </button>
                <button onclick="checkFirebaseStatus()" class="bg-yellow-500 text-white py-2 px-4 rounded hover:bg-yellow-600">
                    –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Firebase
                </button>
                <button onclick="testNavigation()" class="bg-indigo-500 text-white py-2 px-4 rounded hover:bg-indigo-600">
                    –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                </button>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4">üìä –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h2>
            <div id="log" class="bg-gray-100 p-4 rounded-lg text-sm font-mono max-h-96 overflow-y-auto">
                <div class="log-entry log-info">üöÄ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</div>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <!-- Firebase SDK v10 (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–Ω–æ–Ω–∏–º–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Custom Scripts -->
    <script src="js-hashed/firebase-init.a9f4627c.js"></script>
    <script src="js-hashed/demo-login-system.f9518e6f.js"></script>
    <script src="js-hashed/role-middleware.4b8163dc.js"></script>
    
    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            const className = `log-entry log-${type}`;
            logDiv.innerHTML += `<div class="${className}">[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '<div class="log-entry log-info">üöÄ –õ–æ–≥ –æ—á–∏—â–µ–Ω</div>';
        }
        
        function checkFirebaseStatus() {
            log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Firebase...', 'info');
            
            if (typeof firebase === 'undefined') {
                log('‚ùå Firebase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'error');
                return;
            }
            
            if (!firebase.auth) {
                log('‚ùå Firebase Auth –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'error');
                return;
            }
            
            if (!firebase.firestore) {
                log('‚ùå Firebase Firestore –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'error');
                return;
            }
            
            log('‚úÖ Firebase –∑–∞–≥—Ä—É–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = firebase.auth().currentUser;
            if (user) {
                log(`üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.email}`, 'success');
            } else {
                log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω', 'info');
            }
        }
        
        function testNavigation() {
            log('üß≠ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...', 'info');
            
            const testUrls = [
                '/dashboard',
                '/employer-dashboard', 
                '/agency-dashboard',
                '/admin-dashboard'
            ];
            
            testUrls.forEach(url => {
                log(`üîó –ü—Ä–æ–≤–µ—Ä–∫–∞ URL: ${url}`, 'info');
            });
        }
        
        async function testDemoLogin(role) {
            log(`üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç –¥–µ–º–æ-–≤—Ö–æ–¥–∞ –¥–ª—è —Ä–æ–ª–∏: ${role}`, 'info');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase
                if (typeof firebase === 'undefined') {
                    throw new Error('Firebase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                
                if (!firebase.auth) {
                    throw new Error('Firebase Auth –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                
                log('‚úÖ Firebase –ø—Ä–æ–≤–µ—Ä–µ–Ω', 'success');
                
                // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä DemoLoginSystem
                if (!window.demoLoginSystem) {
                    window.demoLoginSystem = new DemoLoginSystem();
                    log('‚úÖ DemoLoginSystem —Å–æ–∑–¥–∞–Ω', 'success');
                }
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–º–æ-–≤—Ö–æ–¥
                log('üîÑ –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–º–æ-–≤—Ö–æ–¥...', 'info');
                await window.demoLoginSystem.handleDemoLogin(role);
                log(`‚úÖ –î–µ–º–æ-–≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω –¥–ª—è —Ä–æ–ª–∏: ${role}`, 'success');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                setTimeout(() => {
                    const user = firebase.auth().currentUser;
                    if (user) {
                        log(`üéâ –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: ${user.email}`, 'success');
                        log('üìç –û–∂–∏–¥–∞–π—Ç–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞—à–±–æ—Ä–¥...', 'info');
                    } else {
                        log('‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ø–æ—Å–ª–µ –¥–µ–º–æ-–≤—Ö–æ–¥–∞', 'warning');
                    }
                }, 2000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error);
            }
        }
        
        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        if (typeof firebase !== 'undefined' && firebase.auth) {
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    log(`üîê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ${user.email}`, 'success');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    firebase.firestore().collection('users').doc(user.uid).get()
                        .then(doc => {
                            if (doc.exists) {
                                const userData = doc.data();
                                log(`üë§ –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${userData.role || '–Ω–µ —É–∫–∞–∑–∞–Ω–∞'}`, 'info');
                                log(`üé≠ –î–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç: ${userData.isDemoAccount ? '–î–∞' : '–ù–µ—Ç'}`, 'info');
                            }
                        })
                        .catch(error => {
                            log(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è: ${error.message}`, 'error');
                        });
                } else {
                    log('üîì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω', 'info');
                }
            });
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                checkFirebaseStatus();
            }, 1000);
        });
        
        log('‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞', 'success');
    </script>
</body>
</html> 